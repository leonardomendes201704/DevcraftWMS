<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Especificacao - Fluxo de Saida (WMS-OUT-001)</title>
    <link rel="stylesheet" href="../../../src/DevcraftWMS.DemoMvc/wwwroot/lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../src/DevcraftWMS.DemoMvc/wwwroot/lib/bootstrap-icons/font/bootstrap-icons.css">
    <style>
        :root { --bg: #f8fafc; --card: #ffffff; --border: #e2e8f0; --ink: #0f172a; --muted: #64748b; --primary: #0d6efd; }
        body { background: var(--bg); color: var(--ink); }
        .toc a { text-decoration: none; color: var(--ink); }
        .toc a:hover { color: var(--primary); }
        .badge-soft { background: #e7f1ff; color: #0d6efd; }
        .section-title { border-bottom: 1px solid var(--border); padding-bottom: .5rem; margin-bottom: 1rem; }
        .callout { background: var(--card); border: 1px solid var(--border); border-left: 4px solid var(--primary); border-radius: .5rem; padding: 1rem; }
        .icon-card { border: 1px solid var(--border); border-radius: .75rem; background: var(--card); padding: 1rem; }
        .icon-card i { font-size: 1.5rem; }
        .small-muted { color: var(--muted); font-size: .9rem; }
        .sticky-top { top: 1rem; }
        .pill { background: #f1f5f9; border: 1px solid var(--border); border-radius: 999px; padding: .25rem .75rem; font-size: .85rem; }
        .tag { font-size: .85rem; padding: .2rem .6rem; border-radius: .5rem; background: #f1f5f9; border: 1px solid var(--border); }
        .section-card { border: 0; box-shadow: 0 1px 2px rgba(15, 23, 42, .08); }
        code { background: #f8fafc; padding: .15rem .35rem; border-radius: .3rem; border: 1px solid #e5e7eb; }
        .step-list li { margin-bottom: .5rem; }
    </style>
</head>
<body>
<div class="container py-4">
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-1">Especificacao - Fluxo de Saida (WMS-OUT-001)</h1>
            <div class="text-muted">Outbound: Separacao, Conferencia, Packing e Expedicao</div>
        </div>
        <div class="d-flex align-items-center gap-2">
            <span class="pill"><i class="bi bi-box-arrow-up-right me-1"></i>Epic WMS-OUT-001</span>
            <span class="badge badge-soft rounded-pill px-3 py-2">Documento base</span>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-lg-8">
            <div id="overview" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-clipboard-check me-2"></i>Visao geral</h2>
                    <p>
                        Este documento descreve o fluxo completo de saida e expedicao no WMS, desde o pedido
                        do cliente (OS) ate a entrega, cobrindo separacao, conferencia, embalagem, carregamento,
                        status e rastreabilidade por UL/SSCC e lote/validade.
                    </p>
                    <div class="callout">
                        <strong>Objetivo:</strong> garantir rastreabilidade, acuracia de separacao, controle de divergencias,
                        expedicao segura e indicadores de performance (KPIs).
                    </div>
                </div>
            </div>

            <div id="context" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-building me-2"></i>Contexto do cliente e produtos</h2>
                    <ul>
                        <li><strong>Cliente:</strong> AutoPecas Orion (Cliente A) no CD Vale Verde (3PL).</li>
                        <li><strong>Produtos sem lote/validade:</strong> itens de ferragem.</li>
                        <li><strong>Produtos com lote/validade:</strong> adesivos, selantes, quimicos.</li>
                        <li><strong>Produtos especiais:</strong> inflamaveis, frageis, alto valor.</li>
                    </ul>
                </div>
            </div>

            <div id="flow" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-diagram-3 me-2"></i>Fluxo principal (happy path)</h2>
                    <ol class="step-list">
                        <li>Cliente cria OS com itens e previsao de expedicao.</li>
                        <li>Backoffice aprova e libera a OS, gerando Pick Order.</li>
                        <li>Separacao executa picking com FEFO/FIFO quando aplicavel.</li>
                        <li>Conferencia valida itens e registra divergencias.</li>
                        <li>Packing gera volumes, pesos e etiquetas.</li>
                        <li>Expedicao carrega na doca e emite documentos.</li>
                        <li>OS expedida e notificada ao cliente.</li>
                    </ol>
                </div>
            </div>

            <div id="roles" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-people me-2"></i>Atores e responsabilidades</h2>
                    <div class="row g-2">
                        <div class="col-md-4"><span class="tag">Cliente</span> Cria OS e acompanha status.</div>
                        <div class="col-md-4"><span class="tag">Backoffice</span> Libera OS e define regras.</div>
                        <div class="col-md-4"><span class="tag">Separador</span> Executa picking.</div>
                        <div class="col-md-4"><span class="tag">Conferente</span> Confere e registra divergencias.</div>
                        <div class="col-md-4"><span class="tag">Embalador</span> Packing, peso e etiquetas.</div>
                        <div class="col-md-4"><span class="tag">Doca</span> Carregamento e expedicao.</div>
                    </div>
                </div>
            </div>

            <div id="orders" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-receipt me-2"></i>OS e Pick Order</h2>
                    <ul>
                        <li>OS criada via Portal/EDI com SKUs, quantidades, prioridade e janela.</li>
                        <li>Backoffice valida estoque e libera OS.</li>
                        <li>Pick Order gerada com metodo (wave/batch/zone/single).</li>
                    </ul>
                </div>
            </div>

            <div id="picking" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-box-seam me-2"></i>Separacao (Picking)</h2>
                    <ul>
                        <li>Picking por endereco otimizado.</li>
                        <li>FEFO/FIFO para itens controlados.</li>
                        <li>Bloqueio de quarentena e estoque reservado.</li>
                        <li>Excecoes: falta, SKU divergente, endereco bloqueado.</li>
                    </ul>
                </div>
            </div>

            <div id="check" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-clipboard2-check me-2"></i>Conferencia e packing</h2>
                    <ul>
                        <li>Conferencia cega/assistida conforme regra.</li>
                        <li>Divergencias obrigam ocorrencia e evidencia.</li>
                        <li>Embalagem, peso e dimensoes finais.</li>
                        <li>Etiquetas de volumes e documentos de carga.</li>
                    </ul>
                </div>
            </div>

            <div id="shipping" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-truck me-2"></i>Expedicao</h2>
                    <ul>
                        <li>Alocacao em doca e registro de horarios.</li>
                        <li>Carregamento com bipagem de volumes/ULs.</li>
                        <li>Emissao de romaneio, etiqueta e NF-e.</li>
                        <li>Status: Expedido ou Expedido Parcial.</li>
                    </ul>
                </div>
            </div>

            <div id="rules" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-shield-check me-2"></i>Regras de negocio (RN)</h2>
                    <ul>
                        <li><strong>RN-01:</strong> FEFO/FIFO obrigatorio para produtos controlados.</li>
                        <li><strong>RN-02:</strong> quarentena bloqueia separacao.</li>
                        <li><strong>RN-03:</strong> reserva de estoque ao liberar OS.</li>
                        <li><strong>RN-04:</strong> conferencia dupla para alto valor.</li>
                        <li><strong>RN-05:</strong> divergencia de peso/volume gera alerta.</li>
                        <li><strong>RN-06:</strong> cancelamento de OS exige permissao e motivo.</li>
                    </ul>
                </div>
            </div>

            <div id="statuses" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-diagram-2 me-2"></i>Status principais</h2>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>OS</strong>
                                <p class="small-muted mb-0">Registrada → Liberada → Em separacao → Conferida → Embalada → Em expedicao → Expedida</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Pick Order</strong>
                                <p class="small-muted mb-0">Criada → Em separacao → Separada → Conferida → Finalizada</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>UL/Volume</strong>
                                <p class="small-muted mb-0">Em estoque → Separada → Conferida → Embalada → Embarcada</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="exceptions" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-exclamation-triangle me-2"></i>Fluxos alternativos</h2>
                    <ul>
                        <li>Sem estoque suficiente → OS parcial ou backorder.</li>
                        <li>Cross-dock outbound → separacao direto da doca de recebimento.</li>
                        <li>Lote bloqueado → substituicao por outro lote (com aprovacao).</li>
                        <li>Cancelamento apos separacao → devolucao ao estoque com auditoria.</li>
                    </ul>
                </div>
            </div>

            <div id="kpis" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-speedometer2 me-2"></i>KPIs sugeridos</h2>
                    <ul>
                        <li>Tempo medio de separacao</li>
                        <li>Tempo de conferencia</li>
                        <li>Tempo total OS→Expedido</li>
                        <li>Taxa de divergencias</li>
                        <li>Indice de expedicao parcial</li>
                    </ul>
                </div>
            </div>

            <div id="screens" class="card section-card mb-3">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-window me-2"></i>Mapa de telas (sugestao)</h2>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Portal Cliente</strong>
                                <p class="small-muted mb-0">Criar OS, anexar docs, acompanhar status.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Backoffice</strong>
                                <p class="small-muted mb-0">Fila de OS, liberar, priorizar, cancelar.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Separacao</strong>
                                <p class="small-muted mb-0">Fila de picking, confirmacao de separacao.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Conferencia</strong>
                                <p class="small-muted mb-0">Revisao de itens e divergencias.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Packing</strong>
                                <p class="small-muted mb-0">Embalagem, pesos e etiquetas.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="icon-card h-100">
                                <strong>Expedicao</strong>
                                <p class="small-muted mb-0">Doca, carregamento, documentos.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="apis" class="card section-card mb-5">
                <div class="card-body">
                    <h2 class="h5 section-title"><i class="bi bi-braces me-2"></i>APIs minimas (proposta)</h2>
                    <ul>
                        <li><code>POST /api/outbound-orders</code></li>
                        <li><code>GET /api/outbound-orders?status=...</code></li>
                        <li><code>POST /api/outbound-orders/{id}/release</code></li>
                        <li><code>POST /api/picking/tasks/{id}/confirm</code></li>
                        <li><code>POST /api/outbound-orders/{id}/check</code></li>
                        <li><code>POST /api/outbound-orders/{id}/pack</code></li>
                        <li><code>POST /api/outbound-orders/{id}/ship</code></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card section-card sticky-top">
                <div class="card-body">
                    <h2 class="h6 mb-3">Navegacao</h2>
                    <div class="toc d-grid gap-2">
                        <a href="#overview"><i class="bi bi-clipboard-check me-2"></i>Visao geral</a>
                        <a href="#context"><i class="bi bi-building me-2"></i>Contexto</a>
                        <a href="#flow"><i class="bi bi-diagram-3 me-2"></i>Fluxo principal</a>
                        <a href="#roles"><i class="bi bi-people me-2"></i>Atores</a>
                        <a href="#orders"><i class="bi bi-receipt me-2"></i>OS e PO</a>
                        <a href="#picking"><i class="bi bi-box-seam me-2"></i>Picking</a>
                        <a href="#check"><i class="bi bi-clipboard2-check me-2"></i>Conferencia/packing</a>
                        <a href="#shipping"><i class="bi bi-truck me-2"></i>Expedicao</a>
                        <a href="#rules"><i class="bi bi-shield-check me-2"></i>Regras</a>
                        <a href="#statuses"><i class="bi bi-diagram-2 me-2"></i>Status</a>
                        <a href="#exceptions"><i class="bi bi-exclamation-triangle me-2"></i>Excecoes</a>
                        <a href="#kpis"><i class="bi bi-speedometer2 me-2"></i>KPIs</a>
                        <a href="#screens"><i class="bi bi-window me-2"></i>Telas</a>
                        <a href="#apis"><i class="bi bi-braces me-2"></i>APIs</a>
                    </div>
                    <hr>
                    <div class="small-muted">
                        <i class="bi bi-info-circle me-1"></i>Documento base para criacao das tasks do fluxo de saida.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
